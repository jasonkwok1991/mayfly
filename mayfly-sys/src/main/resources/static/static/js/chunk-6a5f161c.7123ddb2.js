(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a5f161c"],{"07d70":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"toolbar"},[i("div",{staticStyle:{float:"left"}},[i("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入key",size:"mini",clearable:""},on:{clear:function(t){return e.clear()}},model:{value:e.scanParam.match,callback:function(t){e.$set(e.scanParam,"match",t)},expression:"scanParam.match"}}),i("el-button",{attrs:{type:"success",icon:"el-icon-search",size:"mini",plain:""},on:{click:function(t){return e.search()}}},[e._v("搜索")]),i("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",plain:""},on:{click:function(t){return e.save(!1)}}},[e._v("添加")]),i("el-button",{attrs:{icon:"el-icon-refresh",size:"mini",plain:""},on:{click:function(t){return e.scan()}}},[e._v("换一批")])],1),i("div",{staticStyle:{float:"right"}},[i("span",[e._v("keys:"+e._s(e.dbsize))])])]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{cursor:"pointer"},attrs:{data:e.keys,border:"",stripe:"","highlight-current-row":!0}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"key",label:"key"}}),i("el-table-column",{attrs:{prop:"type",label:"type",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.enums.ValueTypeEnum.getLabelByValue(t.row.type)))]}}])}),i("el-table-column",{attrs:{prop:"ttl",label:"ttl(过期时间)",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.ttlConveter(t.row.ttl)))]}}])}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.redisKey.code,expression:"permission.redisKey.code"}],attrs:{type:"success",icon:"el-icon-search",size:"mini",plain:""},on:{click:function(i){return e.getValue(t.row.key)}}},[e._v("查看")]),i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.redisKey.code,expression:"permission.redisKey.code"}],attrs:{type:"primary",icon:"el-icon-edit",size:"mini",plain:""},on:{click:function(i){return e.update(t.row.key)}}},[e._v("修改")]),i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.del.code,expression:"permission.del.code"}],attrs:{type:"danger",size:"mini",icon:"el-icon-delete",plain:""},on:{click:function(i){return e.del(t.row.key)}}},[e._v("删除")])]}}])})],1),i("div",{staticStyle:{"text-align":"center","margin-top":"10px"}}),i("value-dialog",{attrs:{visible:e.valueDialog.visible,keyValue:e.valueDialog.value},on:{"update:visible":function(t){return e.$set(e.valueDialog,"visible",t)}}})],1)},n=[],s=(i("d3b7"),i("ac1f"),i("466d"),i("ddb0"),i("96cf"),i("1da1")),r=i("d4ec"),c=i("bee2"),l=i("262e"),o=i("2caf"),u=i("9ab4"),d=i("60a3"),p=i("5620"),v=i("d2d5"),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.keyValue.key,visible:e.visible,"show-close":!1,width:"650px"}},[i("el-form",[i("el-form-item",[i("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:15},autocomplete:"off"},model:{value:e.keyValue.value,callback:function(t){e.$set(e.keyValue,"value",t)},expression:"keyValue.value"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("确 定")]),i("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.cancel()}}},[e._v("取 消")])],1)],1)},m=[],h=function(e){Object(l["a"])(i,e);var t=Object(o["a"])(i);function i(){return Object(r["a"])(this,i),t.apply(this,arguments)}return Object(c["a"])(i,[{key:"cancel",value:function(){this.$emit("update:visible",!1),this.$emit("cancel")}}]),i}(d["c"]);Object(u["a"])([Object(d["b"])()],h.prototype,"visible",void 0),Object(u["a"])([Object(d["b"])()],h.prototype,"keyValue",void 0),Object(u["a"])([Object(d["b"])()],h.prototype,"title",void 0),h=Object(u["a"])([Object(d["a"])({name:"ValueDialog"})],h);var b=h,y=b,k=i("2877"),g=Object(k["a"])(y,f,m,!1,null,null,null),w=g.exports,O=i("6cd5"),j=function(e){Object(l["a"])(i,e);var t=Object(o["a"])(i);function i(){var e;return Object(r["a"])(this,i),e=t.apply(this,arguments),e.permission=v["b"],e.loading=!0,e.enums=p["a"],e.cluster=0,e.redis={id:0,info:"",conf:""},e.scanParam={id:0,cluster:0,match:null,count:12,cursor:null,prevCursor:null},e.valueDialog={visible:!1,value:{}},e.keys=[],e.dbsize=0,e}return Object(c["a"])(i,[{key:"mounted",value:function(){this.redis.id=parseInt(this.$route.params.id),this.cluster=parseInt(this.$route.params.cluster),this.scan()}},{key:"scan",value:function(){var e=this;this.loading=!0,this.scanParam.id=0==this.cluster?this.redis.id:this.cluster,this.scanParam.cluster=0==this.cluster?0:1,O["c"].scan.request(this.scanParam).then((function(t){e.keys=t.keys,e.dbsize=t.dbsize,e.scanParam.cursor=t.cursor,e.loading=!1}))}},{key:"search",value:function(){this.scanParam.cursor=null,this.scan()}},{key:"clear",value:function(){this.scanParam.match=null,this.scanParam.cursor=null,this.scan()}},{key:"getValue",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=0==this.cluster?this.redis.id:this.cluster,e.next=3,O["c"].value.request({cluster:this.cluster,key:t,id:i});case 3:a=e.sent,this.valueDialog.value=a,this.valueDialog.visible=!0;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"update",value:function(e){}},{key:"del",value:function(e){var t=this;this.$confirm("此操作将删除对应的key , 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=0==t.cluster?t.redis.id:t.cluster;O["c"].del.request({cluster:t.cluster,key:e,id:i}).then((function(e){t.$message.success("删除成功！"),t.scan()}))})).catch((function(e){}))}},{key:"ttlConveter",value:function(e){if(-1===e)return"永久";e||(e=0);var t=parseInt(e),i=0,a=0,n=0;t>60&&(i=parseInt(t/60+""),t%=60,i>60&&(a=parseInt(i/60+""),i%=60,a>24&&(n=parseInt(a/24+""),a%=24)));var s=t+"s";return i>0&&(s=i+"m:"+s),a>0&&(s=a+"h:"+s),n>0&&(s=n+"d:"+s),s}}]),i}(d["c"]);j=Object(u["a"])([Object(d["a"])({name:"RedisOperation",components:{ValueDialog:w}})],j);var x=j,_=x,F=Object(k["a"])(_,a,n,!1,null,null,null);t["default"]=F.exports},2945:function(e,t,i){"use strict";var a=i("d4ec"),n=i("bee2"),s=i("d789"),r=function(){function e(t,i){Object(a["a"])(this,e),this.url=t,this.method=i}return Object(n["a"])(e,[{key:"setUrl",value:function(e){return this.url=e,this}},{key:"setMethod",value:function(e){return this.method=e,this}},{key:"getUrl",value:function(){return s["a"].getApiUrl(this.url)}},{key:"request",value:function(e){return s["a"].send(this,e)}}],[{key:"create",value:function(t,i){return new e(t,i)}}]),e}();t["a"]=r},"466d":function(e,t,i){"use strict";var a=i("d784"),n=i("825a"),s=i("50c4"),r=i("1d80"),c=i("8aa5"),l=i("14c3");a("match",1,(function(e,t,i){return[function(t){var i=r(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,i):new RegExp(t)[e](String(i))},function(e){var a=i(t,e,this);if(a.done)return a.value;var r=n(e),o=String(this);if(!r.global)return l(r,o);var u=r.unicode;r.lastIndex=0;var d,p=[],v=0;while(null!==(d=l(r,o))){var f=String(d[0]);p[v]=f,""===f&&(r.lastIndex=c(o,s(r.lastIndex),u)),v++}return 0===v?null:p}]}))},5620:function(e,t,i){"use strict";var a=i("a7e9");t["a"]={FileTypeEnum:(new a["a"]).add("DIRECTORY","目录",1).add("FILE","文件",2),ValueTypeEnum:(new a["a"]).add("string","string",1).add("set","set",2)}},"6cd5":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return r}));var a=i("2945"),n={list:a["a"].create("/devops/machines","get"),info:a["a"].create("/devops/machines/{id}/sysinfo","get"),top:a["a"].create("/devops/machines/{id}/top","get"),monitors:a["a"].create("/devops/machines/{id}/{type}/monitors","get"),save:a["a"].create("/devops/machines","post"),update:a["a"].create("/devops/machines/{id}","put"),del:a["a"].create("/devops/machines/{id}","delete"),files:a["a"].create("/devops/machines/{id}/files","get"),lsFile:a["a"].create("/devops/machines/files/{fileId}/ls","get"),rmFile:a["a"].create("/devops/machines/files/{fileId}/rm","delete"),uploadFile:a["a"].create("/devops/machines/files/upload","post"),fileContent:a["a"].create("/devops/machines/files/{fileId}/cat","get"),updateFileContent:a["a"].create("/devops/machines/files/{id}","put"),addConf:a["a"].create("/devops/machines/{machineId}/files","post"),delConf:a["a"].create("/devops/machines/files/{id}","delete")},s={list:a["a"].create("/devops/redis","get"),info:a["a"].create("/devops/redis/{id}/info","get"),del:a["a"].create("/devops/redis/{id}","delete"),save:a["a"].create("/devops/redis","post"),update:a["a"].create("/devops/redis/{id}","put")},r={scan:a["a"].create("/devops/redis/{cluster}/{id}/scan","get"),value:a["a"].create("/devops/redis/{cluster}/{id}/value","get"),update:a["a"].create("/devops/redis/{cluster}/{id}","put"),del:a["a"].create("/devops/redis/{cluster}/{id}","delete")}},a7e9:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var a=i("d4ec"),n=i("bee2"),s=function(){function e(){Object(a["a"])(this,e)}return Object(n["a"])(e,[{key:"add",value:function(e,t,i){return this[e]={label:t,value:i},this}},{key:"getLabelByValue",value:function(e){if(void 0===e||null===e)return"";for(var t in this){var i=this[t];if(i&&i.value===e)return i.label}return""}}]),e}()},d2d5:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return r}));var a=i("2262"),n={machine:a["a"].code("machine"),del:a["a"].code("machine:delete"),machineFile:a["a"].code("machineFile"),rmFile:a["a"].code("machineFile:rm"),uploadFile:a["a"].code("machineFile:upload"),updateFileContent:a["a"].code("machineFile:updateFileContent"),addConf:a["a"].code("machineFile:addConf")},s={redis:a["a"].code("redis")},r={redisKey:a["a"].code("redis:key"),del:a["a"].code("redis:key:delete")}}}]);